<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Logo YÃ¶netimi - Rota 34 Admin</title>
    <link rel="stylesheet" href="admin.css">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>
    <div class="admin-wrapper">
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="sidebar-logo">
                    <span>ğŸ¯</span>
                    <h2>Rota 34 Admin</h2>
                </div>
                <div class="user-info">
                    <div class="user-avatar">ğŸ‘¤</div>
                    <div>
                        <strong>Admin</strong>
                        <p style="font-size: 0.85rem; opacity: 0.7;">YÃ¶netici</p>
                    </div>
                </div>
            </div>
            
            <nav class="sidebar-menu">
                <a href="dashboard.html" class="menu-item">
                    <span>ğŸ“Š</span> Dashboard
                </a>
                <a href="colors.html" class="menu-item">
                    <span>ğŸ¨</span> Renkler & Tema
                </a>
                <a href="logo.html" class="menu-item active">
                    <span>ğŸ–¼ï¸</span> Logo YÃ¶netimi
                </a>
                <a href="homepage.html" class="menu-item">
                    <span>ğŸ </span> Ana Sayfa
                </a>
                <a href="features-management.html" class="menu-item">
                    <span>â­</span> Ã–zellikler
                </a>
                <a href="contact-page.html" class="menu-item">
                    <span>ğŸ“</span> Ä°letiÅŸim SayfasÄ±
                </a>
                <a href="footer-settings.html" class="menu-item">
                    <span>ğŸ“„</span> Footer AyarlarÄ±
                </a>
            </nav>
        </aside>

        <main class="main-content">
            <div class="top-bar">
                <h1>ğŸ–¼ï¸ Logo YÃ¶netimi</h1>
                <button class="btn-logout" onclick="logout()">Ã‡Ä±kÄ±ÅŸ Yap</button>
            </div>

            <div id="successMsg" class="success-msg" style="display: none;"></div>
            <div id="loadingMsg" class="success-msg" style="display: none; background: #fff3cd; color: #856404;">â³ YÃ¼kleniyor...</div>

            <div class="card">
                <h2 class="card-title">ğŸ“ Logo Metni</h2>
                <div class="form-group">
                    <label>Logo YazÄ±sÄ±</label>
                    <input type="text" id="logoText" placeholder="Rota 34">
                    <small style="color: #999;">Logo yanÄ±nda gÃ¶rÃ¼necek metin</small>
                </div>
                <button class="btn btn-primary" onclick="saveLogo()">ğŸ’¾ Kaydet</button>
            </div>

            <div class="card">
                <h2 class="card-title">ğŸ¨ Logo Ä°konu</h2>
                <p style="color: #666; margin-bottom: 1.5rem;">
                    Logo iÃ§in bir emoji seÃ§in
                </p>
                
                <div class="form-group">
                    <label>Emoji SeÃ§imi (HÄ±zlÄ±)</label>
                    <div style="display: grid; grid-template-columns: repeat(8, 1fr); gap: 0.5rem; margin-bottom: 1rem;">
                        <button type="button" onclick="selectEmoji('ğŸ¯')" class="emoji-btn">ğŸ¯</button>
                        <button type="button" onclick="selectEmoji('ğŸš€')" class="emoji-btn">ğŸš€</button>
                        <button type="button" onclick="selectEmoji('â­')" class="emoji-btn">â­</button>
                        <button type="button" onclick="selectEmoji('ğŸ”¥')" class="emoji-btn">ğŸ”¥</button>
                        <button type="button" onclick="selectEmoji('ğŸ’')" class="emoji-btn">ğŸ’</button>
                        <button type="button" onclick="selectEmoji('ğŸª')" class="emoji-btn">ğŸª</button>
                        <button type="button" onclick="selectEmoji('ğŸŒŸ')" class="emoji-btn">ğŸŒŸ</button>
                        <button type="button" onclick="selectEmoji('ğŸ’«')" class="emoji-btn">ğŸ’«</button>
                    </div>
                </div>

                <div class="form-group">
                    <label>Veya Ã–zel Emoji</label>
                    <input type="text" id="logoEmoji" placeholder="ğŸ¯" maxlength="2">
                </div>
            </div>

            <div class="card">
                <h2 class="card-title">ğŸ‘ï¸ Logo Ã–nizleme</h2>
                <div style="padding: 3rem; background: linear-gradient(135deg, #0F2027 0%, #203A43 100%); border-radius: 15px; text-align: center;">
                    <div style="display: inline-flex; align-items: center; gap: 1rem; padding: 1rem 2rem; background: rgba(255,255,255,0.1); border-radius: 50px;">
                        <span id="logoPreview" style="font-size: 3rem;">ğŸ¯</span>
                        <span id="textPreview" style="font-size: 2rem; color: white; font-weight: 800;">Rota 34</span>
                    </div>
                </div>
            </div>

            <div class="card">
                <h2 class="card-title">â„¹ï¸ Bilgi</h2>
                <p style="color: #666; line-height: 1.8;">
                    <strong>Not:</strong> Logo deÄŸiÅŸiklikleri tÃ¼m sayfalarda (Ana Sayfa, Ã–zellikler, Ä°letiÅŸim) otomatik olarak gÃ¼ncellenecektir.
                    DeÄŸiÅŸikliklerinizi gÃ¶rmek iÃ§in sayfayÄ± yenilemeniz gerekebilir.
                </p>
            </div>
        </main>
    </div>

    <script src="admin.js"></script>
    <script>
        // Supabase Configuration
        const SUPABASE_URL = 'https://zyjtcywneublnmssiqhm.supabase.co';
        const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inp5anRjeXduZXVibG5tc3NpcWhtIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc2NzcxODEzOSwiZXhwIjoyMDgzMjk0MTM5fQ.FGbUjKbRsd0GQXeJD6-MM6VfVsFGt2CHDrjwiKE8EYA';
        
        let supabaseClient;

        // Sayfa yÃ¼klendiÄŸinde
        window.addEventListener('DOMContentLoaded', async () => {
            console.log('Logo yÃ¶netimi yÃ¼klendi');
            
            // Supabase baÅŸlat
            supabaseClient = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);
            console.log('âœ… Supabase baÄŸlandÄ±');
            
            // Logo bilgilerini yÃ¼kle
            await loadLogo();
        });

        // Emoji seÃ§imi
        function selectEmoji(emoji) {
            document.getElementById('logoEmoji').value = emoji;
            document.getElementById('logoPreview').textContent = emoji;
            
            // TÃ¼m emoji butonlarÄ±ndan seÃ§imi kaldÄ±r
            document.querySelectorAll('.emoji-btn').forEach(btn => {
                btn.style.borderColor = '#eee';
                btn.style.background = 'white';
            });
            
            // SeÃ§ili butonu iÅŸaretle
            event.target.style.borderColor = '#FF6B35';
            event.target.style.background = '#fff5f2';
        }

        // Logo verilerini Supabase'den yÃ¼kle
        async function loadLogo() {
            const loadingMsg = document.getElementById('loadingMsg');
            loadingMsg.style.display = 'block';
            
            try {
                console.log('ğŸ“¡ Logo verileri yÃ¼kleniyor...');
                
                const { data, error } = await supabaseClient
                    .from('site_settings')
                    .select('*')
                    .eq('key', 'logo')
                    .single();

                if (error && error.code !== 'PGRST116') {
                    throw error;
                }

                console.log('ğŸ“¦ Supabase yanÄ±tÄ±:', data);

                if (data && data.value) {
                    const logo = data.value;
                    document.getElementById('logoText').value = logo.text || 'Rota 34';
                    document.getElementById('logoEmoji').value = logo.emoji || 'ğŸ¯';
                    updatePreview();
                    console.log('âœ… Logo yÃ¼klendi');
                } else {
                    console.log('âš ï¸ VarsayÄ±lan logo kullanÄ±lÄ±yor');
                    document.getElementById('logoText').value = 'Rota 34';
                    document.getElementById('logoEmoji').value = 'ğŸ¯';
                    updatePreview();
                }

            } catch (error) {
                console.error('âŒ Logo yÃ¼kleme hatasÄ±:', error);
                showMessage('Hata: ' + error.message, 'error');
            } finally {
                loadingMsg.style.display = 'none';
            }
        }

        // Logo kaydet
        async function saveLogo() {
            const text = document.getElementById('logoText').value.trim();
            const emoji = document.getElementById('logoEmoji').value.trim();

            if (!text || !emoji) {
                alert('LÃ¼tfen logo metni ve emoji girin!');
                return;
            }

            const loadingMsg = document.getElementById('loadingMsg');
            loadingMsg.style.display = 'block';

            try {
                console.log('ğŸ’¾ Logo kaydediliyor...', { text, emoji });

                const { data, error } = await supabaseClient
                    .from('site_settings')
                    .upsert({
                        key: 'logo',
                        value: { text, emoji },
                        updated_at: new Date().toISOString()
                    }, {
                        onConflict: 'key'
                    });

                if (error) {
                    throw error;
                }

                console.log('âœ… Logo kaydedildi:', data);
                updatePreview();
                showMessage('âœ… Logo baÅŸarÄ±yla kaydedildi!', 'success');

            } catch (error) {
                console.error('âŒ Kaydetme hatasÄ±:', error);
                showMessage('âŒ Hata: ' + error.message, 'error');
            } finally {
                loadingMsg.style.display = 'none';
            }
        }

        // Ã–nizlemeyi gÃ¼ncelle
        function updatePreview() {
            const text = document.getElementById('logoText').value;
            const emoji = document.getElementById('logoEmoji').value;
            
            document.getElementById('logoPreview').textContent = emoji;
            document.getElementById('textPreview').textContent = text;
        }

        // Mesaj gÃ¶ster
        function showMessage(message, type) {
            const successMsg = document.getElementById('successMsg');
            successMsg.textContent = message;
            successMsg.style.display = 'block';
            successMsg.style.background = type === 'success' ? '#d4edda' : '#f8d7da';
            successMsg.style.color = type === 'success' ? '#155724' : '#721c24';
            
            setTimeout(() => {
                successMsg.style.display = 'none';
            }, 3000);
        }

        // Input deÄŸiÅŸikliklerinde Ã¶nizlemeyi gÃ¼ncelle
        document.getElementById('logoText').addEventListener('input', updatePreview);
        document.getElementById('logoEmoji').addEventListener('input', updatePreview);
    </script>

    <style>
        .emoji-btn {
            font-size: 2rem;
            padding: 0.5rem;
            border: 2px solid #eee;
            border-radius: 8px;
            cursor: pointer;
            background: white;
            transition: all 0.3s ease;
        }

        .emoji-btn:hover {
            transform: scale(1.1);
            border-color: #FF6B35;
        }

        .success-msg {
            padding: 1rem;
            border-radius: 10px;
            margin-bottom: 1rem;
            font-weight: 600;
        }
    </style>
</body>
</html>